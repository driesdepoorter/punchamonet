<!DOCTYPE html>

<html>
    <head>
        <title>PUNCH A MONET</title>
        <style>
            body { margin: 0; }
            canvas { width: 100%; height: 100% }
        </style>
    </head>
    <body>
        <script src="js/three.min.js"></script>
        <script src="js/FirstPersonControls.js"></script>
        <script src="js/STLLoader.js"></script>
        <script src="js/DDSLoader.js"></script>
		<script src="js/MTLLoader.js"></script>
		<script src="js/OBJMTLLoader.js"></script>

        <script>
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera( 100, window.innerWidth / window.innerHeight, 0.1, 10000 );
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );
            
            // MATERIALS
            var wallMaterial = new THREE.MeshBasicMaterial({ color: 0x834339 });
            
            /*
            var floorTexture = THREE.ImageUtils.loadTexture( 'img/floortexture.jpg' );
            floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
			floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
			floorTexture.repeat.set( 2,2 );
            var floorMaterial = new THREE.MeshBasicMaterial({ map: floorTexture });
            */
           var floorMaterial = new THREE.MeshBasicMaterial({ color:  0xA1815B });
            
            var roofMaterial = new THREE.MeshBasicMaterial({ color: 0xA88E7F });
            
            var frameMaterial = new THREE.MeshBasicMaterial({ color: 0x917B42 });
            
   
            
            
            var texturemonet = THREE.ImageUtils.loadTexture( "img/monet.jpg" );
            var artMaterial = new THREE.MeshBasicMaterial({ color: 0x917B42, map: texturemonet });
            
            //LIGHTS:
            var ambient = new THREE.AmbientLight( 0x444444 );
				scene.add( ambient );

			var directionalLight = new THREE.DirectionalLight( 0xffeedd );
				directionalLight.position.set( 0, 0, 1 ).normalize();
				scene.add( directionalLight );
				
            
            //HAND MODEL:
            var handmesh;
            var loader = new THREE.STLLoader();
				loader.addEventListener( 'load', function ( event ) {
					var geometry = event.content;
					var materialhand = new THREE.MeshPhongMaterial( { ambient: 0x555555, color: 0xAAAAAA, specular: 0x111111, shininess: 200 } );
					handmesh = new THREE.Mesh( geometry, materialhand );
					
				
					
					handmesh.scale.set( 5, 5, 5 );
				
					
					console.log(handmesh);
					scene.add( handmesh );
					
				} );
				loader.load( "models/hand.stl" );
				
			
				//FRAME 3MODEL:
				var onProgress = function ( xhr ) {
					if ( xhr.lengthComputable ) {
						var percentComplete = xhr.loaded / xhr.total * 100;
						console.log( Math.round(percentComplete, 2) + '% downloaded' );
					}
				};

				var onError = function ( xhr ) {
				};
				
				THREE.Loader.Handlers.add( /\.dds$/i, new THREE.DDSLoader() );
				
				var loader = new THREE.OBJMTLLoader();
				loader.load( 'models/frame/painting_frame.obj', 'models/frame/painting_frame.mtl', function ( object ) {

					object.position.x = +194;
					object.rotation.set(0,170,0);
					object.scale.set(8,8,8);
					//object.scale(4);
					scene.add( object );

				}, onProgress, onError );
				
				
			
				
				
				
				
            
            // texture.wrapS = THREE.RepeatWrapping;
            // texture.wrapT = THREE.RepeatWrapping;
            // texture.repeat.set( 4, 4 );
            // BACK WALL
            var backWallGeometry = new THREE.BoxGeometry( 400, 200, 10 );
            var backWall = new THREE.Mesh( backWallGeometry, wallMaterial );
            backWall.position.z = -200;
            scene.add( backWall );
            
            // LEFT WALL
            var leftWallGeometry = new THREE.BoxGeometry( 10, 200, 400 );
            var leftWall = new THREE.Mesh( leftWallGeometry, wallMaterial );
            leftWall.position.x = -200;
            scene.add( leftWall );
            
            // RIGHT WALL
            var rightWallGeometry = new THREE.BoxGeometry( 10, 200, 400 );
            var rightWall = new THREE.Mesh( rightWallGeometry, wallMaterial );
            rightWall.position.x = +200;
            scene.add( rightWall );
            
            // FRONT WALL
            var frontWallGeometry = new THREE.BoxGeometry( 400, 200, 10 );
            var frontWall = new THREE.Mesh( backWallGeometry, wallMaterial );
            frontWall.position.z = +200;
            scene.add( frontWall );
            
            // FLOOR
            var floorGeometry = new THREE.BoxGeometry( 400, 10, 400 );
            var floor = new THREE.Mesh( floorGeometry, floorMaterial );
            floor.position.y = -100;
            scene.add( floor );
            
            // ROOF
            var roofGeometry = new THREE.BoxGeometry( 400, 10, 400 );
            var roof = new THREE.Mesh( roofGeometry, roofMaterial );
            roof.position.y = +100;
            scene.add( roof );
            
            // MONET FRAME
            var frameGeometry = new THREE.BoxGeometry( 1, 50, 75 );
            var frame = new THREE.Mesh( frameGeometry, artMaterial );
            frame.position.x = +195;
            scene.add( frame );
            console.log(artMaterial);
            
            
            // Add MONET IMAGE
            // var img = new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture('img/monet.jpg')});
            // // img.position.x = -180;
            // img.map.needsUpdate = true; //ADDED
            // var ambientLight = new THREE.AmbientLight(0xbbbbbb);
            // scene.add(ambientLight);
            
            camera.position.z = 0;
            controls = new THREE.FirstPersonControls( camera );
            controls.movementSpeed = 500000;
            controls.lookSpeed = 300;
            controls.lookVertical = false;           
            var clock = new THREE.Clock();
            function render() {
                requestAnimationFrame( render );
                var t = clock.getElapsedTime(); 
                controls.update( clock.getDelta() );
                renderer.render( scene, camera );
                
                	var pos = camera.position;
					var rot = camera.rotation;
					
					handmesh.rotation.x = rot.x;
					handmesh.rotation.y = rot.y;
					handmesh.rotation.z = rot.z;
					
					handmesh.position.x = pos.x + 60;
					handmesh.position.y = pos.y + 80;
					handmesh.position.z = pos.z - 120;
					
            }
            render();
        </script>
    </body>
</html>